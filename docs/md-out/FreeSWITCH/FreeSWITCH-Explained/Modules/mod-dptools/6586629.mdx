
# mod_dptools: deflect 

 Created by  Maximiliano Guerra de Medeiros, last modified by  Bao Nguyen on 2021.11.02

# About

  
Deflect sends a SIP REFER to the originator of an answered call.The deflect application allows FreeSWITCHâ„¢ to be removed from the list of connection hops and tell the originator to reroute the call. When using the deflect application, FreeSWITCH first hangs up (\*) the channel and then sends a REFER message and a new INVITE message to the originator. The originator, which could be a gateway or SIP proxy, should read the INVITE and reroute the call accordingly.

(\*) Starting with FreeSWITCH 1.10.7, a variable named _sip\_refer\_continue\_after\_reply_ is introduced, if `True`, will let the current call continues as is, after sending the REFER message. This is useful when testing rfc4579 REFER method to request a Focus to Add a New Resource to a Conference

  
Click here to expand Table of Contents

* 1 [Usage](#usage)
* 2 [Refer](#refer)
* 3 [See also](#see-also)

# Usage

The only parameter should be the SIP URI to contact (with or without "sip:")

```xml
<action application="deflect" data="sip:someone@somewhere.com" />
```

Important

Refer can only be used on established calls. That means if the channel has been answered (using the answer app), you can use deflect to send a REFER message back to the originating URI. If If the channel has not been answered, then you should use the redirect application to route the call.

# Refer

REFER is a SIP method as defined by [RFC 3515](https://tools.ietf.org/html/rfc3515). The REFER method indicates that the recipient (identified by the Request-URI) should contact a third party using the contact information provided in the request.

Although this is not "deflect" related, but REFER related, it can be useful to know you can retrieve variables with [Variable\_export\_vars](/confluence/pages/createpage.action?spaceKey=FREESWITCH&title=Variable+export+vars&linkCreation=true&fromPageId=6586629) in the a-leg from your initial INVITE when the REFER method hits the dialplan.

# See also

* [mod\_dptools: redirect](./6586707.mdx#tips)
* [sip\_refer\_continue\_after\_reply](../../../Channel-Variables-Catalog/sip_refer_continue_after_reply_61210905.mdx#usage)

  

